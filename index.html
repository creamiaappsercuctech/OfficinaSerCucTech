<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#111827" />
  <title>OfficinaPlus PWA</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">OP</div>
      <div>
        <div class="title">OfficinaPlus</div>
        <div class="subtitle">Causa → Verifica → Riparazione • Audio • Report</div>
      </div>
    </div>
    <div class="top-actions">
      <a class="btn ghost" href="admin.html">Admin</a>
      <button class="btn ghost" id="btnInstall" hidden>Installa</button>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Accettazione cliente</h2>

      <div class="grid2">
        <div>
          <label>Cliente</label>
          <input id="clientName" placeholder="Es. Mario Rossi" autocomplete="name" />
        </div>
        <div>
          <label>Veicolo (targa/VIN/modello)</label>
          <input id="vehicleId" placeholder="Es. AB123CD / WDB..." />
        </div>
      </div>

      <label>Cosa dice il cliente (parole sue)</label>
      <textarea id="clientSays" rows="3" placeholder="Es. A freddo fa un rumore metallico per 2-3 secondi..."></textarea>

      <div class="row">
        <button class="btn" id="btnAnalyze">Analizza e proponi cause</button>
        <button class="btn ghost" id="btnClear">Nuova scheda</button>
      </div>

      <div class="hint">
        Suggerimento: inserisci qui anche “quando succede” (freddo/caldo), “dove” (anteriore/posteriore), “in accelerazione/frenata”, ecc.
      </div>
    </section>

    <section class="card">
      <div class="row space">
        <h2>Percorso riparazione</h2>
        <div class="row">
          <input id="searchAll" class="search" placeholder="Cerca: rumore, P0299, tendicatena, vibrazione..." />
          <button class="btn ghost" id="btnStopAudio">Stop audio</button>
        </div>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="cause">1) Causa</button>
        <button class="tab" data-tab="verify">2) Verifica</button>
        <button class="tab" data-tab="repair">3) Riparazione</button>
        <button class="tab" data-tab="report">Report</button>
      </div>

      <div id="tab-cause" class="tabpane active">
        <h3>Cause proposte</h3>
        <div id="causeList" class="list"></div>
        <div class="row">
          <button class="btn" id="btnToVerify" disabled>Vai a Verifica</button>
        </div>
      </div>

      <div id="tab-verify" class="tabpane">
        <h3>Verifica (checklist)</h3>
        <div id="verifyChecklist" class="checklist"></div>
        <div class="row">
          <button class="btn ghost" id="btnBackToCause">← Indietro</button>
          <button class="btn" id="btnToRepair" disabled>Vai a Riparazione</button>
        </div>
      </div>

      <div id="tab-repair" class="tabpane">
        <h3>Riparazione (step)</h3>
        <div id="repairSteps" class="steps"></div>

        <div class="row">
          <button class="btn ghost" id="btnBackToVerify">← Indietro</button>
          <button class="btn" id="btnToReport">Vai a Report</button>
        </div>
      </div>

      <div id="tab-report" class="tabpane">
        <h3>Report finale (condivisione / stampa)</h3>

        <label>Diagnosi / causa confermata</label>
        <input id="confirmedCause" placeholder="Es. Tendicinghia servizi usurato" />

        <label>Azioni eseguite (note officina)</label>
        <textarea id="actionsDone" rows="3" placeholder="Es. sostituito tendicinghia, controllo cinghia, prova a freddo OK"></textarea>

        <label>Ricambi utilizzati</label>
        <textarea id="partsUsed" rows="2" placeholder="Es. Tendicinghia OEM, cinghia servizi"></textarea>

        <label>Esito test finale</label>
        <input id="finalTest" placeholder="Es. Avviamento a freddo OK, rumore assente, prova strada OK" />

        <div class="row">
          <button class="btn" id="btnBuildReport">Genera report</button>
          <button class="btn ghost" id="btnShare">Condividi</button>
          <button class="btn ghost" id="btnPrint">Stampa / Salva PDF</button>
        </div>

        <pre id="reportOut" class="report"></pre>
      </div>
    </section>

    <section class="card">
      <h2>Offline & Installazione</h2>
      <ul class="bullets">
        <li>Questa PWA funziona offline dopo il primo caricamento.</li>
        <li>Su Android: menu ⋮ del browser → “Aggiungi a schermata Home” oppure usa “Installa”.</li>
      </ul>
    </section>
  </main>

  <footer class="footer">
    <span>OfficinaPlus • PWA</span>
    <span class="muted">v1.0</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
